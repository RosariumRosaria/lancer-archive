<div
  class="card passcode-widget"
  data-widget="passcode"
  data-hash="{{ hash }}"
>
  {% sectionHeader "RESTRICTED SECTION" %}
  Credential Verification
  {% endsectionHeader %}



  <form class="passcode-form" novalidate>
    <div class="field">
      <label class="field-label" for="passcode-input">
        Passcode
      </label>
      <input
        id="passcode-input"
        class="field-input"
        type="password"
        autocomplete="off"
        autocapitalize="off"
        spellcheck="false"
        inputmode="text"
        required
      >
    </div>

    <div class="terminal-row">
      <button
        class="btn btn-primary"
        type="submit"
      >
        UNLOCK
      </button>
    </div>



    <p
      class="smallprint system-error status"
      hidden
    >
      ACCESS DENIED. INVALID PASSCODE.
    </p>

            <p class="smallprint">
    Enter authorized passcode to unlock restricted archive contents.
  </p>
  </form>

  <div class="locked" hidden>
    {{ content | safe }}
  </div>
</div>


<script>
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll('[data-widget="passcode"]').forEach(widget => {
      const form = widget.querySelector(".passcode-form");
      const input = widget.querySelector(".field-input");
      const status = widget.querySelector(".status");
      const locked = widget.querySelector(".locked");
      const hash = widget.dataset.hash;

      if (!form) return;

      form.addEventListener("submit", (e) => {
        e.preventDefault();

        status.hidden = true;

        const value = input.value.trim();
        if (!value) return;

        // TEMP: always fail until hash logic is added
        status.hidden = false;
      });
    });
  });
</script>
